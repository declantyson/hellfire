{"version":3,"sources":["../src/game.es6.js"],"names":["Game","element","width","height","fps","canvas","document","getElementById","ctx","getContext","currentKeys","keyChanged","keyBindings","left","jump","right","startingStockCount","setTimeout","clearInterval","window","player","Scene","game","stage","playerOne","setInterval","draw","bind","pre_canvas","createElement","pre_ctx","clearRect","drawStageFloors","drawCharacters","drawCharacterStocks","characterActions","drawImage","i","floors","length","floor","moveTo","x","y","lineTo","stroke","stockIcon","stocks","img","setAttribute","id","hurtboxes","hurtbox","rect","character","drawActions","onkeydown","e","activeGame","keyCode","onkeyup"],"mappings":";;;;;;AAAA;;;;;;;;;IASMA,I;AACF,kBAAYC,OAAZ,EAAqBC,KAArB,EAA4BC,MAA5B,EAAoCC,GAApC,EAAyC;AAAA;;AACrC,aAAKC,MAAL,GAAcC,SAASC,cAAT,CAAwBN,OAAxB,CAAd;AACA,aAAKI,MAAL,CAAYH,KAAZ,GAAoBA,KAApB;AACA,aAAKG,MAAL,CAAYF,MAAZ,GAAqBA,MAArB;AACA,aAAKC,GAAL,GAAWA,GAAX;AACA,aAAKI,GAAL,GAAW,KAAKH,MAAL,CAAYI,UAAZ,CAAuB,IAAvB,CAAX;AACA,aAAKC,WAAL,GAAmB,EAAnB;AACA,aAAKC,UAAL,GAAkB,KAAlB;AACA,aAAKC,WAAL,GAAmB;AACfC,kBAAQ,EADO;AAEfC,kBAAQ,EAFO;AAGfC,mBAAQ;AAHO,SAAnB;AAKA,aAAKC,kBAAL,GAA0B,CAA1B;AACH;;;;mCAEU;AACPC,uBAAW,YAAY;AACnB;AACAC,8BAAcC,OAAOC,MAArB;AACH,aAHD,EAGG,GAHH;AAIH;;;;;;IAGCC,K;AACF,mBAAYC,IAAZ,EAAkBC,KAAlB,EAAyBC,SAAzB,EAAoC;AAAA;;AAChC,aAAKF,IAAL,GAAYA,IAAZ;AACA,aAAKC,KAAL,GAAaA,KAAb;AACA,aAAKC,SAAL,GAAiBA,SAAjB;;AAEAL,eAAOC,MAAP,GAAgBK,YAAY,KAAKC,IAAL,CAAUC,IAAV,CAAe,IAAf,CAAZ,EAAkC,OAAO,KAAKL,IAAL,CAAUlB,GAAnD,CAAhB;AACH;;;;+BAEM;AACH,gBAAIwB,aAAatB,SAASuB,aAAT,CAAuB,QAAvB,CAAjB;AAAA,gBACIC,UAAUF,WAAWnB,UAAX,CAAsB,IAAtB,CADd;AAEAmB,uBAAWzB,MAAX,GAAoB,KAAKmB,IAAL,CAAUjB,MAAV,CAAiBF,MAArC;AACAyB,uBAAW1B,KAAX,GAAmB,KAAKoB,IAAL,CAAUjB,MAAV,CAAiBH,KAApC;;AAEA,iBAAKoB,IAAL,CAAUd,GAAV,CAAcuB,SAAd,CAAwB,CAAxB,EAA2B,CAA3B,EAA8B,KAAKT,IAAL,CAAUjB,MAAV,CAAiBH,KAA/C,EAAsD,KAAKoB,IAAL,CAAUjB,MAAV,CAAiBF,MAAvE;;AAEA,iBAAK6B,eAAL,CAAqBF,OAArB;AACA,iBAAKG,cAAL,CAAoBH,OAApB;AACA,iBAAKI,mBAAL,CAAyBJ,OAAzB;AACA,iBAAKK,gBAAL,CAAsB,KAAKX,SAA3B;;AAEA,iBAAKF,IAAL,CAAUd,GAAV,CAAc4B,SAAd,CAAwBR,UAAxB,EAAoC,CAApC,EAAuC,CAAvC;AACH;;;wCAEeE,O,EAAS;AACrB,iBAAK,IAAIO,IAAI,CAAb,EAAgBA,IAAI,KAAKd,KAAL,CAAWe,MAAX,CAAkBC,MAAtC,EAA8CF,GAA9C,EAAmD;AAC/C,oBAAIG,QAAQ,KAAKjB,KAAL,CAAWe,MAAX,CAAkBD,CAAlB,CAAZ;;AAEAP,wBAAQW,MAAR,CAAeD,MAAME,CAArB,EAAwBF,MAAMG,CAA9B;AACAb,wBAAQc,MAAR,CAAeJ,MAAME,CAAN,GAAUF,MAAMtC,KAA/B,EAAsCsC,MAAMG,CAA5C;AACAb,wBAAQe,MAAR;AACH;AACJ;;;4CAEmBf,O,EAAS;AACzB,gBAAIgB,YAAY,KAAKtB,SAAL,CAAesB,SAA/B;AACA,iBAAK,IAAIT,IAAI,CAAb,EAAgBA,IAAI,KAAKb,SAAL,CAAeuB,MAAnC,EAA2CV,GAA3C,EAAgD;AAC5C,oBAAIW,MAAM1C,SAASuB,aAAT,CAAuB,KAAvB,CAAV;AACAmB,oBAAIC,YAAJ,CAAiB,KAAjB,EAAwB,kBAAkB,KAAKzB,SAAL,CAAe0B,EAAjC,GAAsC,MAA9D;AACApB,wBAAQM,SAAR,CAAkBY,GAAlB,EAAwB,KAAK,KAAKX,CAAlC,EAAsC,EAAtC;AACH;AACJ;;;uCAEcP,O,EAAS;AACpB,iBAAK,IAAIO,IAAI,CAAb,EAAgBA,IAAI,KAAKb,SAAL,CAAe2B,SAAf,CAAyBZ,MAA7C,EAAqDF,GAArD,EAA0D;AACtD,oBAAIe,UAAU,KAAK5B,SAAL,CAAe2B,SAAf,CAAyBd,CAAzB,CAAd;AACAP,wBAAQuB,IAAR,CAAaD,QAAQV,CAArB,EAAwBU,QAAQT,CAAR,GAAYS,QAAQjD,MAA5C,EAAoDiD,QAAQlD,KAA5D,EAAmEkD,QAAQjD,MAA3E;AACA2B,wBAAQe,MAAR;AACH;AACJ;;;yCAEgBS,S,EAAW;AACxBA,sBAAUC,WAAV,CAAsB,KAAKhC,KAA3B;AACH;;;;;;AAGLjB,SAASkD,SAAT,GAAqB,UAAUC,CAAV,EAAa;AAC9B,QAAG,CAACC,WAAWhD,WAAX,CAAuB+C,EAAEE,OAAzB,CAAJ,EAAuC;AACnCD,mBAAW/C,UAAX,GAAwB,IAAxB;AACA+C,mBAAWhD,WAAX,CAAuB+C,EAAEE,OAAzB,IAAoC,IAApC;AACH;AACJ,CALD;;AAOArD,SAASsD,OAAT,GAAmB,UAAUH,CAAV,EAAa;AAC5BC,eAAWhD,WAAX,CAAuB+C,EAAEE,OAAzB,IAAoC,KAApC;AACH,CAFD","file":"game.js","sourcesContent":["/*\n *\n *\tXL Platform Fighter/Game\n *\tXL Gaming/Declan Tyson\n *\tv0.0.18\n *\t16/09/2016\n *\n */\n\nclass Game {\n    constructor(element, width, height, fps) {\n        this.canvas = document.getElementById(element);\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.fps = fps;\n        this.ctx = this.canvas.getContext(\"2d\");\n        this.currentKeys = [];\n        this.keyChanged = false;\n        this.keyBindings = {\n            left  : 37,\n            jump  : 38,\n            right : 39\n        };\n        this.startingStockCount = 4;\n    }\n\n    gameOver() {\n        setTimeout(function () {\n            // TODO: Go to victory screen\n            clearInterval(window.player);\n        }, 100);\n    }\n}\n\nclass Scene {\n    constructor(game, stage, playerOne) {\n        this.game = game;\n        this.stage = stage;\n        this.playerOne = playerOne;\n\n        window.player = setInterval(this.draw.bind(this), 1000 / this.game.fps);\n    }\n\n    draw() {\n        var pre_canvas = document.createElement('canvas'),\n            pre_ctx = pre_canvas.getContext('2d');\n        pre_canvas.height = this.game.canvas.height;\n        pre_canvas.width = this.game.canvas.width;\n\n        this.game.ctx.clearRect(0, 0, this.game.canvas.width, this.game.canvas.height);\n\n        this.drawStageFloors(pre_ctx);\n        this.drawCharacters(pre_ctx);\n        this.drawCharacterStocks(pre_ctx);\n        this.characterActions(this.playerOne);\n\n        this.game.ctx.drawImage(pre_canvas, 0, 0);\n    }\n\n    drawStageFloors(pre_ctx) {\n        for (var i = 0; i < this.stage.floors.length; i++) {\n            var floor = this.stage.floors[i];\n\n            pre_ctx.moveTo(floor.x, floor.y);\n            pre_ctx.lineTo(floor.x + floor.width, floor.y);\n            pre_ctx.stroke();\n        }\n    }\n\n    drawCharacterStocks(pre_ctx) {\n        var stockIcon = this.playerOne.stockIcon;\n        for (var i = 0; i < this.playerOne.stocks; i++) {\n            var img = document.createElement('img');\n            img.setAttribute(\"src\", \"/stock-icons/\" + this.playerOne.id + \".png\");\n            pre_ctx.drawImage(img, (32 + 40 * i), 32);\n        }\n    }\n\n    drawCharacters(pre_ctx) {\n        for (var i = 0; i < this.playerOne.hurtboxes.length; i++) {\n            var hurtbox = this.playerOne.hurtboxes[i];\n            pre_ctx.rect(hurtbox.x, hurtbox.y - hurtbox.height, hurtbox.width, hurtbox.height);\n            pre_ctx.stroke();\n        }\n    }\n\n    characterActions(character) {\n        character.drawActions(this.stage);\n    }\n}\n\ndocument.onkeydown = function (e) {\n    if(!activeGame.currentKeys[e.keyCode]) {\n        activeGame.keyChanged = true;\n        activeGame.currentKeys[e.keyCode] = true;\n    }\n};\n\ndocument.onkeyup = function (e) {\n    activeGame.currentKeys[e.keyCode] = false;\n};"]}