/*! xl-platform-fighter 2016-09-09 */
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Character=function(){function a(b,c,d,e,f,g,h,i,j){_classCallCheck(this,a),this.game=b,this.name=c,this.maxSpeed=d/this.game.fps,this.acceleration=e,this.deceleration=f,this.currentSpeed=0,this.currentDir=g,this.hurtboxes=h,this.turnDelay=i}return _createClass(a,[{key:"move",value:function(){var a=this.maxSpeed/(this.acceleration*this.game.fps);this.currentSpeed<this.maxSpeed&&(this.currentSpeed+=a);for(var b=0;b<this.hurtboxes.length;b++)this.hurtboxes[b].x+=this.currentDir*this.currentSpeed}},{key:"stop",value:function(){var a=this.maxSpeed/(this.deceleration*this.game.fps);this.currentSpeed>0&&(this.currentSpeed-=a,this.currentSpeed<0&&(this.currentSpeed=0));for(var b=0;b<this.hurtboxes.length;b++)this.hurtboxes[b].x+=this.currentDir*this.currentSpeed}},{key:"turn",value:function(){this.currentSpeed=this.maxSpeed/(this.turnDelay*this.game.fps)}}]),a}(),Hurtbox=function a(b,c,d,e){_classCallCheck(this,a),this.x=b,this.y=c,this.width=d,this.height=e},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Game=function a(b,c,d,e){_classCallCheck(this,a),this.canvas=document.getElementById(b),this.canvas.width=c,this.canvas.height=d,this.fps=e,this.ctx=this.canvas.getContext("2d"),this.currentKey=-1,this.keyChanged=!1},Scene=function(){function a(b,c,d){_classCallCheck(this,a),this.game=b,this.stage=c,this.playerOne=d,setInterval(this.draw.bind(this),1e3/this.game.fps)}return _createClass(a,[{key:"draw",value:function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.height=this.game.canvas.height,a.width=this.game.canvas.width,this.game.ctx.clearRect(0,0,this.game.canvas.width,this.game.canvas.height),this.drawStageFloors(b),this.drawCharacters(b),this.characterActions(this.playerOne),this.game.ctx.drawImage(a,0,0)}},{key:"drawStageFloors",value:function(a){for(var b=0;b<this.stage.floors.length;b++){var c=this.stage.floors[b];a.moveTo(c.startX,c.startY),a.lineTo(c.endX,c.endY),a.stroke()}}},{key:"drawCharacters",value:function(a){for(var b=0;b<this.playerOne.hurtboxes.length;b++){var c=this.playerOne.hurtboxes[b];a.rect(c.x,c.y-c.height,c.width,c.height),a.stroke()}}},{key:"characterActions",value:function(a){if("undefined"!=typeof keys[this.game.currentKey]){var b=keys[this.game.currentKey];"right"==b?(this.game.keyChanged&&(a.turn(),this.game.keyChanged=!1),a.currentDir=1,a.move()):"left"==b?(this.game.keyChanged&&(a.turn(),this.game.keyChanged=!1),a.currentDir=-1,a.move()):"stop"==b&&a.stop()}}}]),a}(),keys={"-1":"stop",37:"left",39:"right"};document.onkeydown=function(a){activeGame.currentKey!==a.keyCode&&(activeGame.keyChanged=!0,activeGame.currentKey=a.keyCode)},document.onkeyup=function(){activeGame.currentKey=-1};var Stage=function a(b,c,d){_classCallCheck(this,a),this.game=b,this.name=c,this.floors=d},Floor=function a(b,c,d,e){_classCallCheck(this,a),this.startX=b,this.startY=c,this.endX=d,this.endY=e};