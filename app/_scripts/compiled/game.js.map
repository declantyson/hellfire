{"version":3,"sources":["../src/game.es6.js"],"names":["Game","element","width","height","fps","canvas","document","getElementById","ctx","getContext","currentKey","keyChanged","Scene","game","stage","playerOne","setInterval","draw","bind","pre_canvas","createElement","pre_ctx","clearRect","drawStageFloors","drawCharacters","characterActions","drawImage","i","floors","length","floor","moveTo","startX","startY","lineTo","endX","endY","stroke","hurtboxes","hurtbox","rect","x","y","character","fall","gravity","keys","action","currentDir","turn","move","stop","onkeydown","e","activeGame","keyCode","onkeyup"],"mappings":"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","file":"game.js","sourcesContent":["/*\n *\n *\tXL Platform Fighter/Game\n *\tXL Gaming/Declan Tyson\n *\tv0.0.2\n *\t07/09/2016\n *\n */\n\nclass Game {\n    constructor(element, width, height, fps) {\n        this.canvas = document.getElementById(element);\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.fps = fps;\n        this.ctx = this.canvas.getContext(\"2d\");\n        this.currentKey = -1;\n        this.keyChanged = false;\n    }\n}\n\nclass Scene {\n    constructor(game, stage, playerOne) {\n        this.game = game;\n        this.stage = stage;\n        this.playerOne = playerOne;\n\n        // this.draw();\n        setInterval(this.draw.bind(this), 1000 / this.game.fps);\n    }\n\n    draw() {\n        var pre_canvas = document.createElement('canvas'),\n            pre_ctx = pre_canvas.getContext('2d');\n        pre_canvas.height = this.game.canvas.height;\n        pre_canvas.width = this.game.canvas.width;\n\n        this.game.ctx.clearRect(0, 0, this.game.canvas.width, this.game.canvas.height);\n\n        this.drawStageFloors(pre_ctx);\n        this.drawCharacters(pre_ctx);\n        this.characterActions(this.playerOne);\n\n        this.game.ctx.drawImage(pre_canvas, 0, 0);\n    }\n\n    drawStageFloors(pre_ctx) {\n        for (var i = 0; i < this.stage.floors.length; i++) {\n            var floor = this.stage.floors[i];\n\n            pre_ctx.moveTo(floor.startX, floor.startY);\n            pre_ctx.lineTo(floor.endX, floor.endY);\n            pre_ctx.stroke();\n        }\n    }\n\n    drawCharacters(pre_ctx) {\n        for (var i = 0; i < this.playerOne.hurtboxes.length; i++) {\n            var hurtbox = this.playerOne.hurtboxes[i];\n            pre_ctx.rect(hurtbox.x, hurtbox.y - hurtbox.height, hurtbox.width, hurtbox.height);\n            pre_ctx.stroke();\n        }\n    }\n\n    characterActions(character) {\n        character.fall(this.stage.gravity, this.stage.floors);\n\n        if(typeof keys[this.game.currentKey] === \"undefined\") return;\n        var action = keys[this.game.currentKey];\n\n        if(action == \"right\") {\n            if(this.game.keyChanged && character.currentDir !== 1) {\n                character.turn(1);\n            }\n            character.move();\n        } else if(action == \"left\") {\n            if(this.game.keyChanged && character.currentDir !== -1) {\n                character.turn(-1);\n            }\n            character.move();\n        } else if(action == \"stop\") {\n            character.stop();\n        }\n    }\n}\n\n\nvar keys = {\n    \"-1\" : \"stop\",\n    \"37\" : \"left\",\n    \"39\" : \"right\",\n};\n\ndocument.onkeydown = function (e) {\n    if(activeGame.currentKey !== e.keyCode) {\n        activeGame.keyChanged = true;\n        activeGame.currentKey = e.keyCode;\n    }\n};\n\ndocument.onkeyup = function () {\n    activeGame.currentKey = -1;\n};"]}