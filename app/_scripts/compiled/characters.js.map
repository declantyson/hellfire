{"version":3,"sources":["../src/characters.es6.js"],"names":["Character","game","startPosX","startPosY","stocks","startingStockCount","opts","id","name","maxSpeed","fps","acceleration","deceleration","turnDelay","hurtboxes","hitboxes","weight","airSpeed","jumpPower","jumpHeight","allowedJumps","jumpThreshold","keysHeld","currentSpeed","currentFallSpeed","currentDir","currentVerticalDir","jumpStart","y","jumpsRemaining","jumping","stun","currentAttack","invulnerable","visibleHitboxes","damage","stage","fall","gravity","floors","key","keyBindings","attacks","currentKeys","i","length","push","currentFrame","endFrame","cooldown","hitstun","right","keyChanged","turn","move","left","stop","jump","jumpHeld","up","down","hurt","hurtbox","c","players","character","hit","hitbox","active","x","calculatedX","width","height","yOffset","getHit","canvas","loseStock","gameOver","angleToSpeedModifier","angle","knockback","dir","setTimeout","maxMovementSpeed","hitFloor","h","f","floor","Hurtbox","Hitbox","xOffset","growth","startFrame","hitstunFrames"],"mappings":"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","file":"characters.js","sourcesContent":["/*\n *\n *\tXL Platform Fighter/Characters\n *\tXL Gaming/Declan Tyson\n *\tv0.0.118\n *\t23/09/2016\n *\n */\n\nclass Character {\n    constructor(game, startPosX, startPosY) {\n        this.game = game;\n        this.startPosX = startPosX;\n        this.startPosY = startPosY;\n        this.stocks = this.game.startingStockCount;\n    }\n\n    initialise(opts) {\n        // attributes\n        this.id = opts.id;\n        this.name = opts.name;\n        this.maxSpeed = opts.maxSpeed / this.game.fps;\n        this.acceleration = opts.acceleration;\n        this.deceleration = opts.deceleration;\n        this.turnDelay = opts.turnDelay;\n        this.hurtboxes = opts.hurtboxes;\n        this.hitboxes = opts.hitboxes;\n        this.weight = 1/opts.weight;\n        this.airSpeed = opts.airSpeed / this.game.fps;\n        this.jumpPower = 1/opts.jumpPower;\n        this.jumpHeight = opts.jumpHeight;\n        this.allowedJumps = opts.allowedJumps;\n        this.jumpThreshold = opts.jumpThreshold;\n\n        // state\n        this.keysHeld = {};\n        this.currentSpeed = 0;\n        this.currentFallSpeed = 0;\n        this.currentDir = opts.currentDir;\n        this.currentVerticalDir = 1;\n        this.jumpStart = this.hurtboxes[0].y;\n        this.jumpsRemaining = opts.allowedJumps;\n        this.jumping = false;\n        this.stun = false;\n        this.currentAttack = -1;\n        this.invulnerable = false;\n        this.visibleHitboxes = [];\n\n        this.damage = 0;\n    }\n    \n    drawActions(stage) {\n        this.fall(stage.gravity, stage.floors);\n        this.visibleHitboxes = [];\n\n        for(var key in this.keyBindings.attacks) {\n            if (this.game.currentKeys[this.keyBindings.attacks[key]] && !this.stun) {\n                if (this.currentAttack === -1) this.currentAttack = this.keyBindings.attacks[key];\n                if (this.currentAttack !== this.keyBindings.attacks[key]) continue;\n                for (var i = 0; i < this.hitboxes[key].length; i++) {\n                    this.visibleHitboxes.push(this.hitboxes[key][i]);\n                }\n            } else {\n                for (var i = 0; i < this.hitboxes[key].length; i++) {\n                    if (this.hitboxes[key][i].currentFrame > this.hitboxes[key][i].endFrame + this.hitboxes[key][i].cooldown) {\n                        this.hitboxes[key][i].currentFrame = 0;\n                        this.currentAttack = -1;\n                    }\n                    if (this.currentAttack === this.keyBindings.attacks[key]) {\n                        this.visibleHitboxes.push(this.hitboxes[key][i]);\n                    }\n                }\n                this.keysHeld[this.keyBindings[key]] = false;\n            }\n        }\n\n        if(this.stun) {\n            this.hitstun();\n        } else if(this.game.currentKeys[this.keyBindings.right]) {\n            if (this.game.keyChanged && this.currentDir !== 1) {\n                this.turn(1);\n            }\n            this.move();\n        } else if (this.game.currentKeys[this.keyBindings.left]) {\n            if (this.game.keyChanged && this.currentDir !== -1) {\n                this.turn(-1);\n            }\n            this.move();\n        } else {\n            this.stop();\n        }\n\n        if (this.game.currentKeys[this.keyBindings.jump] && !this.stun) {\n            if(this.jumpHeld) return;\n            this.jumpHeld = true;\n            if (this.jumpsRemaining > 0) {\n                if (\n                    (this.currentVerticalDir === -1 &&\n                    this.jumpsRemaining < this.allowedJumps &&\n                    this.hurtboxes[0].y > this.jumpStart - this.jumpThreshold.up)\n                        ||\n                    (this.currentVerticalDir === 1 &&\n                    this.jumpsRemaining < this.allowedJumps &&\n                    this.hurtboxes[0].y > this.jumpStart - this.jumpThreshold.down)\n                ) {\n                    return;\n                }\n                this.jumpStart = this.hurtboxes[0].y;\n                this.currentVerticalDir = -1;\n                this.jumpsRemaining--;\n            }\n        } else {\n            this.jumpHeld = false;\n        }\n\n        if(!this.invulnerable) {\n            for (var hurt = 0; hurt < this.hurtboxes.length; hurt++) {\n                var hurtbox = this.hurtboxes[hurt];\n                for (var c = 0; c < this.game.players.length; c++) {\n                    var character = this.game.players[c].character;\n                    if (this === character) continue;\n                    for (var hit = 0; hit < character.visibleHitboxes.length; hit++) {\n                        var hitbox = character.visibleHitboxes[hit];\n                        if (\n                            hitbox.active &&\n                            (hurtbox.x < hitbox.calculatedX + hitbox.width &&\n                            hurtbox.x + hurtbox.width > hitbox.calculatedX) &&\n                            (hurtbox.y - hurtbox.height < character.hurtboxes[0].y - hitbox.yOffset &&\n                            hurtbox.y > character.hurtboxes[0].y - hitbox.yOffset - hitbox.height)\n                        ) {\n                            this.jumpStart = this.hurtboxes[0].y;\n                            this.getHit(hitbox);\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n        if(this.hurtboxes[0].x < 0 || this.hurtboxes[0].y < 0 || this.hurtboxes[0].x > this.game.canvas.width || this.hurtboxes[0].y > this.game.canvas.height) {\n            this.loseStock();\n        }\n    }\n\n    loseStock() {\n        this.stocks--;\n        this.damage = 0;\n        if(this.stocks <= 0) {\n            this.game.gameOver();\n        } else {\n            this.hurtboxes[0].x = this.startPosX;\n            this.hurtboxes[0].y = this.startPosY;\n            this.currentSpeed = 0;\n        }\n    }\n\n    getHit(hitbox) {\n        var angleToSpeedModifier = hitbox.angle / 45;\n\n        this.currentVerticalDir = -1;\n        this.currentFallSpeed = this.currentVerticalDir * angleToSpeedModifier * hitbox.knockback * (1 + (this.damage/100));\n\n        this.damage += hitbox.damage;\n\n        this.currentDir = hitbox.dir;\n        this.currentSpeed = (1 / angleToSpeedModifier) * hitbox.knockback;\n\n        //this.stun = true;\n        this.invulnerable = true;\n\n        var character = this;\n        setTimeout(function () {\n            character.invulnerable = false;\n        }, 100);\n\n        setTimeout(function() {\n            character.stun = false;\n        }, hitbox.hitstun);\n    }\n\n    hitstun() {\n        //this.stop()\n    }\n\n    move() {\n        var maxMovementSpeed = this.maxSpeed;\n        if(this.currentFallSpeed > 0) maxMovementSpeed = this.airSpeed;\n\n        var acceleration = maxMovementSpeed / (this.acceleration * this.game.fps);\n        if(this.currentSpeed < maxMovementSpeed) {\n            this.currentSpeed += acceleration;\n        }\n\n        for(let i = 0; i < this.hurtboxes.length; i++) {\n            this.hurtboxes[i].x += this.currentDir * this.currentSpeed;\n        }\n    }\n\n    stop() {\n        var deceleration = this.maxSpeed / (this.deceleration * this.game.fps);\n        if(this.currentFallSpeed > 0) {\n            deceleration = deceleration / 3;\n        }\n\n        if(this.currentSpeed > 0) {\n            this.currentSpeed -= deceleration;\n            if(this.currentSpeed < 0) this.currentSpeed = 0;\n        }\n\n        for(let i = 0; i < this.hurtboxes.length; i++) {\n            this.hurtboxes[i].x += this.currentDir * this.currentSpeed;\n        }\n    }\n\n    turn(dir) {\n        if(this.currentSpeed === 0) return;\n\n        let deceleration = this.maxSpeed / (this.turnDelay * this.game.fps);\n        if(this.currentSpeed > 0) {\n            this.currentSpeed -= deceleration;\n            if(this.currentSpeed < 0) this.currentSpeed = 0;\n        }\n\n        if(this.currentSpeed === 0) {\n            this.currentDir = dir;\n            this.game.keyChanged = false;\n        }\n    }\n\n    fall(gravity, floors) {\n        if(this.currentVerticalDir === -1) {\n            this.jump(gravity, floors);\n            return;\n        }\n\n        if(this.currentFallSpeed > 0) {\n            this.jumping = false;\n        }\n\n        var hitFloor = false;\n\n        for(let h = 0; h < this.hurtboxes.length; h++) {\n            let hurtbox = this.hurtboxes[h];\n\n            for(let f = 0; f < floors.length; f++) {\n                let floor = floors[f];\n                if(\n                    !this.jumping &&\n                    (hurtbox.y >= floor.y && this.currentVerticalDir === 1) &&\n                    ((hurtbox.y - hurtbox.height <= floor.y)) &&\n                    ((hurtbox.x >= floor.x && hurtbox.x <= floor.x + floor.width) ||\n                    (hurtbox.x + hurtbox.width >= floor.x && hurtbox.x + hurtbox.width <= floor.x + floor.width))\n                ) {\n                    hitFloor = true;\n                    if(this.stun) {\n                        this.stun = false;\n                        this.currentSpeed = this.currentDir;\n                    }\n                    this.hurtboxes[0].y = floor.y;\n                }\n            }\n            if(hitFloor) {\n                this.jumpsRemaining = this.allowedJumps;\n                this.currentFallSpeed = 0;\n                break;\n            } else if(this.jumpsRemaining === this.allowedJumps) {\n                this.jumpsRemaining = this.allowedJumps - 1;\n            }\n\n            this.currentFallSpeed += gravity / (this.weight * this.game.fps);\n            hurtbox.y += this.currentFallSpeed;\n        }\n    }\n    \n    jump(gravity, floors) {\n        if(this.hurtboxes[0].y > this.jumpStart - this.jumpHeight) {\n            this.currentFallSpeed -= gravity / (this.jumpPower * this.game.fps);\n            this.hurtboxes[0].y += this.currentFallSpeed;\n            this.jumping = true;\n        } else if(!this.stun) {\n            this.currentVerticalDir = 1;\n        }\n    }\n}\n\nclass Hurtbox {\n    constructor(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n}\n\nclass Hitbox {\n    constructor(opts) {\n        this.xOffset = opts.xOffset;\n        this.yOffset = opts.yOffset;\n        this.width = opts.width;\n        this.height = opts.height;\n        this.damage = opts.damage;\n        this.angle = opts.angle;\n        this.knockback = opts.knockback;\n        this.growth = opts.growth;\n        this.startFrame = opts.startFrame;\n        this.endFrame = opts.endFrame;\n        this.cooldown = opts.cooldown;\n\n        this.name = opts.name;\n\n        this.dir = 1;\n        this.currentFrame = 0;\n        this.active = false;\n        let hitstunFrames = opts.hitstun || 60;\n        this.hitstun = (hitstunFrames / 60) * 1000;\n    }\n}\n"]}